define(

	["jquery", "underscore", "backbone",
	 "models/session",
	 "hbs!templates/sessiontable"],

	function($, _, Backbone,
			 Session, tableTemplate) {

		var SessionTableView = Backbone.View.extend({

			// tag,ID for the autogenerated node the view will be enclosed in
			tagName: "div",
			id: "sessionTableDialog",

			collection: null,

			events: {
				"click #btnClose": "close",
			},

			initialize: function(options) {

				this.collection = options.sessions || null;

				// if (this.collection) {
				// 	this.listenTo(this.collection, "sort", "this.updateTable");
				// }

				this.render();
			},

			// create the dialog and insert into page DOM
			render: function() {

				var sessionInfo = this.collection.map(function(session) {
					return session.getInfo();
				});
				var context = {
					title: "Sessions",
					sessions: sessionInfo
				};

				this.$el.html(tableTemplate(context));
				$(document.body).append(this.$el);

				return this;
			},

			close: function() {

				this.trigger("dialog:cancel");
				this.remove();
			},
		});

		return SessionTableView;
	}
);